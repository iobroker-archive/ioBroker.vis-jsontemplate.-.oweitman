/*! For license information please see src_JSONTemplateWidget_jsx.cfb87751.chunk.js.LICENSE.txt */
(self.webpackChunkiobroker_vis_2_widgets_jsontemplate=self.webpackChunkiobroker_vis_2_widgets_jsontemplate||[]).push([["src_JSONTemplateWidget_jsx","node_modules_react_jsx-runtime_js-_c3dc0","node_modules_react_jsx-runtime_js-_c3dc1"],{14543:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var o=n(28437),i=n(58093),l=n.n(i),a=n(12727),s=n.n(a),r=(n(27751),n(92210),n(59795),n(90656),n(93516),n(37449)),c=n(36663);s().config.set("basePath","./lib/js/ace"),s().config.setModuleUrl("ace/ext/language_tools","./lib/js/ace/ext-language_tools.js"),s().config.setModuleUrl("ace/theme/clouds_midnight","./lib/js/ace/theme-clouds_midnight.js"),s().config.setModuleUrl("ace/theme/chrome","./lib/js/ace/theme-chrome.js"),s().config.setModuleUrl("ace/ext/searchbox","./lib/js/ace/ext-searchbox.js"),s().config.setModuleUrl("ace/snippets/ejs","./lib/js/ace/snippets/ejs.js"),s().config.setModuleUrl("ace/mode/ejs","./lib/js/ace/mode-ejs.js");const d=e=>{const t=(0,o.useRef)();return(0,o.useEffect)((()=>{let e,t=null;const n=o=>{"f"===o.key&&o.ctrlKey&&(e=setInterval((()=>{var o,i,l,a,s,c,d,u;if(!t)return;const p=t.parentNode;if(!p)return;let g=p.querySelector(".ace_search_field");g&&(clearInterval(e),e=null),"Search for"===(null===(o=g)||void 0===o?void 0:o.placeholder)&&(g.placeholder=r.I18n.t("ace_Search for")),g=p.querySelector('.ace_searchbtn[action="findAll"]'),"All"===(null===(i=g)||void 0===i?void 0:i.innerHTML)&&(g.innerHTML=r.I18n.t("ace_All")),g=p.querySelector('.ace_button[action="toggleRegexpMode"]'),"RegExp Search"===(null===(l=g)||void 0===l?void 0:l.title)&&(g.title=r.I18n.t("ace_RegExp Search")),g=p.querySelector('.ace_button[action="toggleCaseSensitive"]'),"CaseSensitive Search"===(null===(a=g)||void 0===a?void 0:a.title)&&(g.title=r.I18n.t("ace_CaseSensitive Search")),g=p.querySelector('.ace_button[action="toggleWholeWords"]'),"Whole Word Search"===(null===(s=g)||void 0===s?void 0:s.title)&&(g.title=r.I18n.t("ace_Whole Word Search")),g=p.querySelector('.ace_button[action="searchInSelection"]'),"Search In Selection"===(null===(c=g)||void 0===c?void 0:c.title)&&(g.title=r.I18n.t("ace_Search In Selection")),g=p.querySelector('.ace_button[action="toggleReplace"]'),"Toggle Replace mode"===(null===(d=g)||void 0===d?void 0:d.title)&&(g.title=r.I18n.t("ace_Toggle Replace mode")),null===(u=t)||void 0===u||u.removeEventListener("keydown",n),t=null}),100))};return"en"!==r.I18n.getLanguage()&&setTimeout((()=>{var e;t=window.document.querySelector(".ace_text-input"),null===(e=t)||void 0===e||e.addEventListener("keydown",n)}),200),()=>{var o;e&&clearTimeout(e),e=null,null===(o=t)||void 0===o||o.removeEventListener("keydown",n),t=null}}),[]),(0,c.jsx)("div",{style:{width:e.width||"100%",height:e.height||"100%",border:e.error?"1px solid #800":"1px solid transparent"},ref:t,children:(0,c.jsx)(l(),{mode:"ejs",theme:"dark"===themeType?"clouds_midnight":"chrome",width:"100%",height:"100%",value:e.value,onChange:t=>e.onChange(t),readOnly:e.readOnly||!1,focus:e.focus,ref:e.refEditor,highlightActiveLine:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0})})}},6385:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var o=n(28437),i=n(37449),l=n(60173),a=n(14543),s=n(36663);const r=e=>{const[t,n]=(0,o.useState)("");return(0,o.useEffect)((()=>{n(e.value)}),[e.open]),e.open?(0,s.jsx)(l.A,{keyboardDisabled:!0,title:i.I18n.t("vis_2_widgets_json_widget_title"),open:!0,actionTitle:i.I18n.t("vis_2_widgets_json_widget_save"),action:()=>e.onChange(t),onClose:e.onClose,minWidth:800,actionDisabled:t===e.value,children:(0,s.jsx)(a.A,{value:t,focus:!0,height:400,onChange:e=>n(e)})}):null}},35936:(e,t,n)=>{const{createElement:o,useEffect:i,useRef:l}=n(28437);e.exports=function(e){let{html:t,dangerouslySetInnerHTML:n,allowRerender:a,...s}=e;const r=l(null),c=l(!0);return i((()=>{if(!t||!r.current)throw new Error("html prop can't be null");c.current=Boolean(a);const e=document.createRange().createContextualFragment(t);r.current.innerHTML="",r.current.appendChild(e)}),[t,r,a]),o("div",{...s,ref:r})}},60173:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});n(28437);var o=n(67085),i=n(21839),l=n(37449),a=n(36663);const s=e=>e.open?(0,a.jsxs)(o.Dialog,{onClose:e.closeDisabled?null:e.onClose,open:!0,fullScreen:!!e.fullScreen,maxWidth:e.maxWidth||"md",children:[(0,a.jsx)(o.DialogTitle,{children:e.noTranslation?e.title:l.I18n.t(e.title)}),(0,a.jsx)(o.DialogContent,{style:{minWidth:e.minWidth||void 0},onKeyUp:t=>{e.action&&(e.actionDisabled||e.keyboardDisabled||"Enter"===t.key&&(e.action(),e.actionNoClose||e.onClose()))},children:e.children}),(0,a.jsxs)(o.DialogActions,{children:[e.dialogActions||null,e.actionTitle?(0,a.jsx)(o.Button,{variant:"contained",onClick:()=>{e.action&&e.action(),e.actionNoClose||e.onClose()},color:e.actionColor||"primary",disabled:e.actionDisabled,startIcon:e.ActionIcon?(0,a.jsx)(e.ActionIcon,{}):void 0,children:e.noTranslation?e.actionTitle:l.I18n.t(e.actionTitle)}):null,(0,a.jsx)(o.Button,{variant:"contained",color:"grey",onClick:e.onClose,disabled:e.closeDisabled,startIcon:(0,a.jsx)(i.Close,{}),children:e.noTranslation&&e.closeTitle?e.closeTitle:l.I18n.t(e.closeTitle||"Cancel")})]})]}):null},8599:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var o=n(28437),i=n(67085),l=n(21839),a=n(37449),s=n(6385),r=n(36663);const c=e=>{let{field:t,data:n,onDataChange:c}=e;const[d,u]=(0,o.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.TextField,{sx:{".MuiInputBase-input":{fontSize:"80%"}},size:"small",variant:"standard",value:n&&n[t.name],fullWidth:!0,error:!1,helperText:a.I18n.t(""),onChange:e=>{c({[t.name]:e.target.value})},InputProps:{endAdornment:(0,r.jsx)(i.Button,{size:"small",onClick:()=>u(!0),children:(0,r.jsx)(l.Edit,{})})},rows:2}),d?(0,r.jsx)(s.A,{open:!0,value:n[t.name],onChange:e=>c({[t.name]:e}),onClose:()=>u(!1)}):null]})}},90626:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});n(28437),n(67085);var o=n(95973),i=n.n(o),l=n(59797),a=n(8599),s=n(35936),r=n.n(s),c=n(36663);const d=n(73984);class u extends(window.visRxWidget||l.VisRxWidget){static getWidgetInfo(){return{id:"tplJSONTemplateWidget",visSet:"vis-2-widgets-jsontemplate",visSetLabel:"vis_2_jsontemplatewidget",visName:"JSON Widget",visAttrs:[{name:"common",fields:[{name:"oid",type:"id",label:"vis_2_widgets_json_oid"},{name:"template",type:"custom",label:"vis_2_widgets_json_template",component:(e,t,n,o)=>(0,c.jsx)(a.A,{visSocket:o.context.socket,field:e,data:t,onDataChange:n,props:!0})},{name:"dpcount",type:"number",default:1,min:1,max:Number.MAX_VALUE,step:1,label:"vis_2_widgets_json_dpcount",onChange:async(e,t,n)=>{const{dpcount:o}=t;for(let i=0;i<=o;i++)t[`g_datapoints-${i}`]=!0;n(t)}}]},{name:"datapoints",label:"vis_2_widgets_json_datapointsgroup",indexFrom:1,indexTo:"dpcount",onChange:async(e,t,n)=>{n(t)},fields:[{name:"datapoint-oid",label:"vis_2_widgets_json_datapoints_oid",type:"id"}]}],visDefaultStyle:{width:300,height:300},visPrev:""}}propertiesUpdate(){}componentDidMount(){super.componentDidMount(),this.propertiesUpdate()}getWidgetInfo(){return u.getWidgetInfo()}onRxDataChanged(){this.propertiesUpdate()}onRxStyleChanged(){}onStateUpdated(e,t){}escapeHTML(e){let t=document.createElement("textarea");t.textContent=e;const n=t.innerHTML;return t=null,n}renderWidgetBody(e){let t,n,o,i,l,a;super.renderWidgetBody(e);try{var s;t=JSON.parse(this.state.values[`${this.state.rxData.oid}.val`]||"{}"),n=e.widget.data||{},o=[],l=n.dpcount?n.dpcount:1;for(let e=1;e<=l;e++)n["datapoint-oid"+e]&&(o[n["datapoint-oid"+e]]=this.state.values[`${n["datapoint-oid"+e]}.val`]);i=(null===(s=n)||void 0===s?void 0:s.template)||"",a=d.render(i,{widgetid:e.id,data:t,dp:o,style:e.style})+" "}catch(u){a=this.escapeHTML(u.message).replace(/(?:\r\n|\r|\n)/g,"<br>"),a=a.replace(/ /gm,"&nbsp;"),a=`<code style="color:red;">${a}</code>`}return(0,c.jsx)(r(),{html:a})}}u.propTypes={systemConfig:i().object,socket:i().object,themeType:i().string,style:i().object,data:i().object};const p=u},82973:(e,t,n)=>{"use strict";var o=n(28437),i=Symbol.for("react.element"),l=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,l={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,o)&&!r.hasOwnProperty(o)&&(l[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===l[o]&&(l[o]=t[o]);return{$$typeof:i,type:e,key:c,ref:d,props:l,_owner:s.current}}t.Fragment=l,t.jsx=c,t.jsxs=c},36663:(e,t,n)=>{"use strict";e.exports=n(82973)},77280:()=>{},47024:()=>{}}]);
//# sourceMappingURL=src_JSONTemplateWidget_jsx.cfb87751.chunk.js.map